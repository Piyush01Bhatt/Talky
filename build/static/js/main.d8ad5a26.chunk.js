(this.webpackJsonptalky=this.webpackJsonptalky||[]).push([[0],{139:function(e,t,a){},141:function(e,t,a){},142:function(e,t,a){},155:function(e,t,a){},173:function(e,t,a){},174:function(e,t,a){},175:function(e,t,a){},176:function(e,t,a){},177:function(e,t,a){},178:function(e,t,a){},179:function(e,t,a){},180:function(e,t,a){},181:function(e,t,a){},182:function(e,t,a){},213:function(e,t){},216:function(e,t,a){},217:function(e,t,a){},218:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),s=a.n(c),o=(a(139),a(6)),i=a(11),l=a.n(i),m=a(20),u=a(104),d=a(105),p=a(127),f=a(126),E=(a.p,a.p+"static/media/manage_chats.5a5517dc.svg"),_=(a(141),a(4)),b=(a(142),a.p+"static/media/talky_logo.e1293087.png"),v=a(251),g=a(253),h=a(249),O=Object(h.a)((function(e){return{buttonProgress:{color:"#454fbe",position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),N=function(e){var t=O(),a=Object(n.useState)(!1),c=Object(_.a)(a,2),s=c[0],o=c[1];return r.a.createElement("div",{className:"base-container",ref:e.containerRef},r.a.createElement("div",{className:"topHeader"},r.a.createElement("img",{src:b,alt:"talky"}),r.a.createElement("div",{className:"mui__button"},r.a.createElement(v.a,{onClick:function(){return e.flip()}},"Sign up"))),r.a.createElement("div",{className:"header"},r.a.createElement("h3",null,"Login")),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"form"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",name:"username",placeholder:"username",onChange:e.processLoginEmail})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",name:"password",placeholder:"password",onChange:e.processLoginPassword})))),r.a.createElement("div",{className:"footer"},r.a.createElement(v.a,{type:"button",className:"btn",style:s?{backgroundColor:"#e0e0e0",color:"#9e9e9e"}:{backgroundColor:"#454fbe",color:"#fff"},disabled:s,onClick:function(t){o(!0),e.processLogin(o)}},"Login"),s&&r.a.createElement(g.a,{size:24,className:t.buttonProgress})))},j=a(42),y=a.n(j),w=(a(155),a(43)),S=a.n(w),k=a(254),C=a(72),R=a.n(C),x=a(110),q=a.n(x).a.create({baseURL:"http://0.0.0.0:8001"}),D=Object(h.a)((function(e){return{buttonProgress:{color:"#454fbe",position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));var M=function(e){var t=e.isOpen,a=e.close,c=e.element,s=e.userEmail,o=D(),i=Object(n.useState)(""),u=Object(_.a)(i,2),d=u[0],p=u[1],f=Object(n.useState)(!1),E=Object(_.a)(f,2),b=E[0],h=E[1],O=function(){var e=Object(m.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.prev=1,e.next=4,q.post("/user/auth",{email:s,otp:d});case 4:(t=e.sent)&&!0===t.data.success&&(h(!1),alert("Otp Verified"),p(""),a()),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),alert(e.t0.message);case 12:return e.prev=12,h(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,8,12,15]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(y.a,{isOpen:t,className:"Otp__Modal",overlayClassName:"Overlay",appElement:c,parentSelector:function(){return document.querySelector("#register_base")}},r.a.createElement("div",{className:"otpmodal__body"},r.a.createElement("div",{className:"otpclose__button"},r.a.createElement(k.a,{className:"otpicon_button",onClick:function(){a()}},r.a.createElement(S.a,null))),r.a.createElement("div",{className:"otpmodal__input"},r.a.createElement("input",{value:d,onChange:function(e){return p(e.target.value)},type:"text",name:"otp",placeholder:"otp"})),r.a.createElement("div",{className:"otpmodal__footer"},r.a.createElement("div",{className:"otpsend__button"},r.a.createElement(v.a,{onClick:function(){return O()},className:"otp_verify",style:b?{backgroundColor:"#e0e0e0",color:"#9e9e9e"}:{backgroundColor:"#454fbe",color:"#fff"},disabled:b},"Verify"),b&&r.a.createElement(g.a,{size:24,className:o.buttonProgress})),r.a.createElement("div",{className:"otp__resend"},r.a.createElement(k.a,{className:"otpresend__button"},r.a.createElement(R.a,{className:"otpresend__icon"}))))))},P=Object(h.a)((function(e){return{buttonProgress:{color:"#454fbe",position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),T=function(e){var t=P(),a=Object(n.useState)(!1),c=Object(_.a)(a,2),s=c[0],i=c[1],u=Object(n.useState)({name:"",email:"",password:""}),d=Object(_.a)(u,2),p=d[0],f=d[1],E=Object(n.useState)(!1),h=Object(_.a)(E,2),O=h[0],N=h[1],j=function(){var e=Object(m.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(!0),e.prev=1,e.next=4,q.post("/user/register",{name:p.name,email:p.email,password:p.password});case 4:!0===e.sent.data.success&&(N(!1),i(!0)),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0.message),N(!1),alert("registration failed");case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"base-container",id:"register_base",ref:e.containerRef},r.a.createElement("div",{className:"topHeader"},r.a.createElement("img",{src:b,alt:"talky"}),r.a.createElement("div",{className:"mui__button"},r.a.createElement(v.a,{onClick:function(){return e.flip()}},"Sign in"))),r.a.createElement("div",{className:"header"},r.a.createElement("h3",null,"Register")),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"form"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",name:"username",placeholder:"username",value:p.name,onChange:function(e){return f(Object(o.a)(Object(o.a)({},p),{},{name:e.target.value}))}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",name:"email",placeholder:"email",value:p.email,onChange:function(e){return f(Object(o.a)(Object(o.a)({},p),{},{email:e.target.value}))}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",name:"password",placeholder:"password",value:p.password,onChange:function(e){return f(Object(o.a)(Object(o.a)({},p),{},{password:e.target.value}))}})))),r.a.createElement("div",{className:"footer"},r.a.createElement(v.a,{onClick:function(){return j()},type:"button",className:"btn",style:O?{backgroundColor:"#e0e0e0",color:"#9e9e9e"}:{backgroundColor:"#454fbe",color:"#fff"},disabled:O},"Register"),O&&r.a.createElement(g.a,{size:24,className:t.buttonProgress})),r.a.createElement(M,{isOpen:s,close:function(){i(!1)},element:document.getElementById("talky"),userEmail:p.email}))},A=(a(173),Object(n.createContext)()),F=function(e){var t=e.reducer,a=e.initialState,c=e.children;return r.a.createElement(A.Provider,{value:Object(n.useReducer)(t,a)},c)},L=function(){return Object(n.useContext)(A)},I=a(59),U=a.n(I),B=a(111),z=a.n(B),W=(a(174),a(263)),Q=a(255);a(175);var V=function(e){return r.a.createElement("p",{className:"chat__receiver"},r.a.createElement("span",{className:"chat__name"},e.name),e.messageBody,r.a.createElement("span",{className:"chat__timestamp"},e.timestamp))};a(176);var G=function(e){return r.a.createElement("p",{className:"chat__message"},r.a.createElement("span",{className:"chat__name"},e.name),e.messageBody,r.a.createElement("span",{className:"chat__timestamp"},e.timestamp))},H=a(113),J=a.n(H),$=a(114),K=a.n($),X=a(112),Y=a.n(X);U.a.extend(z.a);var Z=function(e){var t=e.sendMessage,a=L(),c=Object(_.a)(a,2),s=c[0],o=s.user,i=s.room,l=s.recent_rooms,m=(c[1],Object(n.useState)("")),u=Object(_.a)(m,2),d=u[0],p=u[1];return Object(n.useEffect)((function(){var e=document.getElementById("chatBody");e.scrollTo(e.scrollHeight)})),r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"chat__header"},r.a.createElement(W.a,{className:"chat__header__avatar"}),r.a.createElement("div",{className:"chat__headerInfo"},r.a.createElement("h3",null,i.name),r.a.createElement("p",null,"Last seen at...")),r.a.createElement("div",{className:"chat__headerRight"},r.a.createElement(k.a,{className:"inactive__button",disabled:!0},r.a.createElement(Y.a,null)),r.a.createElement(k.a,{className:"inactive__button",disabled:!0},r.a.createElement(Q.a,null)))),r.a.createElement("div",{className:"chat__body",id:"chatBody"},i.id&&l[i.id].messages.map((function(e,t){return e.from_name===o.name?r.a.createElement(V,{name:o.name,messageBody:e.message,timestamp:U()(e.timestamp).fromNow()}):r.a.createElement(G,{name:e.from_name,messageBody:e.message,timestamp:U()(e.timestamp).fromNow()})}))),r.a.createElement("div",{className:"chat__footer"},r.a.createElement(k.a,{className:"inactive__button",disabled:!0},r.a.createElement(J.a,null)),r.a.createElement("form",null,r.a.createElement("input",{value:d,onChange:function(e){return p(e.target.value)},placeholder:"Type a message",type:"text"}),r.a.createElement("button",{onClick:function(e){t(e,d),p("")},type:"submit"},"Send a Message")),r.a.createElement(k.a,{className:"inactive__button",disabled:!0},r.a.createElement(K.a,null))))},ee=(a(177),a(118)),te=a.n(ee),ae=a(119),ne=a.n(ae),re=a(121),ce=a.n(re);a(178);var se=function(e){var t=e.onClick,a=e.roomName,n=e.index,c=e.roomId,s=L(),o=Object(_.a)(s,1)[0].room;return r.a.createElement("div",{className:o.key===n?"sidebarChat ".concat("sidebarChat_selected"):"sidebarChat",onClick:function(){return t(a,c,n)}},r.a.createElement(W.a,{className:"sidebarChat__avatar"}),r.a.createElement("div",{className:"sidebarChat__info"},r.a.createElement("h2",null,a),r.a.createElement("p",null,"This is the last message .")))},oe=a(120),ie=a.n(oe),le=a(23),me=(a(179),a(264)),ue=(a(180),a(115)),de=a.n(ue),pe=a(30),fe=a.n(pe),Ee=a(58),_e=Object(h.a)((function(e){return{buttonProgress:{color:Ee.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-18,marginLeft:-18}}}));var be=function(e){var t=e.name,a=e.status,c=e.personId,s=e.index,o=(e.user,e.acceptRequest),i=e.rejectRequest,l=_e(),m=Object(n.useState)(!1),u=Object(_.a)(m,2),d=u[0],p=u[1],f=Object(n.useState)(!1),E=Object(_.a)(f,2),b=E[0],v=E[1];return r.a.createElement("div",{className:"list__main"},r.a.createElement(W.a,{className:"list__avatar"}),r.a.createElement("div",{className:"list__info"},r.a.createElement("h2",null,t),r.a.createElement("p",null,a)),r.a.createElement("div",{className:"accept__fab"},r.a.createElement(k.a,{onClick:function(e){return o(s,c,t,a,p)}},r.a.createElement(fe.a,{className:"accept__icon"})),d&&r.a.createElement(g.a,{size:38,className:l.buttonProgress})),r.a.createElement("div",{className:"reject__fab"},r.a.createElement(k.a,{onClick:function(){return i(s,c,t,a,v)}},r.a.createElement(de.a,{className:"reject__icon"})),b&&r.a.createElement(g.a,{size:38,className:l.buttonProgress})))};var ve=function(e){var t=e.isOpen,a=e.closeRequests,c=(e.element,Object(n.useState)("")),s=Object(_.a)(c,2),o=(s[0],s[1],L()),i=Object(_.a)(o,2),u=i[0],d=u.requests,p=u.user,f=i[1],E=function(){var e=Object(m.a)(l.a.mark((function e(t,a,n,r,c){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,q.post("/friends/accept_request",{userId:p._id,friendId:a});case 4:if(e.sent){e.next=7;break}throw new Error("empty response");case 7:(s=Object(le.a)(d)).splice(t,1),f({type:"RESET_REQUESTS",item:s}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:return e.prev=15,c(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})));return function(t,a,n,r,c){return e.apply(this,arguments)}}(),b=function(){var e=Object(m.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,{key:"left"},r.a.createElement(me.a,{anchor:"left",open:t,onClose:a,PaperProps:{style:{position:"absolute"}},BackdropProps:{style:{position:"absolute"}},ModalProps:{container:document.getElementById("chatroomBody"),style:{position:"absolute"}},variant:"temporary"},r.a.createElement("div",{className:"drawer__menu"},d.length>0?d.map((function(e,t){return r.a.createElement(be,{name:e.sentUserName,status:e.sentUserStatus,personId:e.fo_id,user:p,index:t,acceptRequest:E,rejectRequest:b})})):r.a.createElement("h1",null,"Empty"))))},ge=a(260),he=a(56),Oe=a.n(he),Ne=(a(181),a(262)),je=a(257),ye=a(258),we=a(259),Se=a(256),ke=(a(182),Object(h.a)((function(e){return{buttonProgress:{color:Ee.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-18,marginLeft:-18}}})));var Ce=function(e){var t=e.name,a=e.status,c=e.personId,s=e.index,o=e.addToRecent,i=ke(),l=Object(n.useState)(!1),m=Object(_.a)(l,2),u=m[0],d=m[1],p=Object(n.useState)(!1),f=Object(_.a)(p,2),E=f[0],b=f[1];return r.a.createElement("div",{className:"friend__list__main"},r.a.createElement(W.a,{className:"friend__list__avatar"}),r.a.createElement("div",{className:"friend__list__info"},r.a.createElement("h2",null,t),r.a.createElement("p",null,a)),r.a.createElement("div",{className:"add__fab"},r.a.createElement(k.a,{className:"add__to__recent",onClick:function(){o(s,c,t,a,d,b)},disabled:u},E?r.a.createElement(fe.a,{className:"add__icon"}):r.a.createElement(Oe.a,{className:"add__icon"})),u&&r.a.createElement(g.a,{size:24,className:i.buttonProgress})))},Re=a(117),xe=a.n(Re),qe=a(116),De=a.n(qe);var Me=function(e){var t=e.isOpen,a=e.handleClose,n=r.a.useState(0),c=Object(_.a)(n,2),s=c[0],o=c[1],i=L(),l=Object(_.a)(i,2),m=l[0],u=(m.requests,m.user),d=(m.recent_rooms,m.fromMeRequestedFriends),p=m.toMeRequestedFriends,f=l[1],E=function(e,t,a,n,r,c){r(!0);var s={};s[t]={name:a,status:n,messages:[]},f({item:s,type:"ADD_ROOM"}),r(!1),c(!0)},b=r.a.createElement("div",{className:"my__friends__body"},r.a.createElement(Se.a,{position:"sticky"},r.a.createElement(Ne.a,{value:s,onChange:function(e,t){o(t),0===t&&q.get("/friends/from_me_requested/".concat(u._id,"/",1,"/",10)).then((function(e){f({type:"ADD_FROM_ME_FRIENDS",item:e.data.data})}),(function(e){console.log(e)})),0===t&&q.get("/friends/to_me_requested/".concat(u._id,"/",1,"/",10)).then((function(e){console.log(e.data),f({type:"ADD_TO_ME_FRIENDS",item:e.data.data})}),(function(e){console.log(e)}))},"aria-label":"simple tabs example"},r.a.createElement(je.a,{label:"My Requested Friends"}),r.a.createElement(je.a,{label:"To Me Requested Friends"}))),0===s&&d.length>0&&d.map((function(e,t){return r.a.createElement(Ce,{name:e.name,status:e.status,personId:e.u_id,addToRecent:E})})),1===s&&p.length>0&&p.map((function(e,t){return r.a.createElement(Ce,{name:e.sentUserName,status:e.sentUserStatus,personId:e.fo_id,addToRecent:E})})));return r.a.createElement("div",null,r.a.createElement(ye.a,{open:t,onClose:a,className:"my__friends__modal"},b,r.a.createElement(we.a,null,r.a.createElement(k.a,null,r.a.createElement(De.a,null)),r.a.createElement(k.a,null,r.a.createElement(xe.a,null)),r.a.createElement(v.a,{onClick:a,color:"primary"},"Close"))))},Pe=Object(h.a)((function(e){return{fab:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}}));var Te=function(e){e.user;var t=e.findFriend,a=L(),c=Object(_.a)(a,2),s=c[0].recent_rooms,o=c[1],i=Object(n.useState)(!1),l=Object(_.a)(i,2),m=l[0],u=l[1],d=Object(n.useState)(!1),p=Object(_.a)(d,2),f=p[0],E=p[1],b=Pe(),v=function(e,t,a){o({type:"SET_ROOM",item:{name:e,id:t,key:a}})};return r.a.createElement("div",{className:"sidebar",id:"chatroom_sidebar"},r.a.createElement("div",{className:"sidebar__header"},r.a.createElement("div",{className:"avatar__container"},r.a.createElement(W.a,{className:"avatar__icon"})),r.a.createElement("div",{className:"sidebar__headerRight"},r.a.createElement(k.a,{className:"inactive_button",disabled:!0},r.a.createElement(te.a,null)),r.a.createElement(k.a,{className:"action_button",onClick:function(e){return u(!0)}},r.a.createElement(ne.a,null)),r.a.createElement(k.a,{onClick:function(e){return t()},className:"action_button"},r.a.createElement(ie.a,null)))),r.a.createElement("div",{className:"sidebar__right"},r.a.createElement("div",{className:"sidebar__search"},r.a.createElement("div",{className:"sidebar__searchContainer"},r.a.createElement(ce.a,null),r.a.createElement("input",{placeholder:"Search or start new chat",type:"text"}))),r.a.createElement("div",{className:"sidebar__chats"},s&&Object.entries(s).map((function(e,t){return r.a.createElement(se,{onClick:v,roomName:e[1].name,index:t,key:t,roomId:e[0]})}))),r.a.createElement(ge.a,{color:"primary","aria-label":"add",className:b.fab,onClick:function(){return E(!0)}},r.a.createElement(Oe.a,null))),r.a.createElement(ve,{isOpen:m,closeRequests:function(){u(!1)},element:document.getElementById("talky")}),r.a.createElement(Me,{isOpen:f,handleClose:function(){E(!1)}}))},Ae=a(122),Fe=a.n(Ae),Le=r.a.createContext();function Ie(e){var t=e.id,a=e.user,c=e.children,s=Object(n.useState)(),o=Object(_.a)(s,2),i=o[0],l=o[1],m=L(),u=Object(_.a)(m,2),d=(u[0],u[1]);return Object(n.useEffect)((function(){console.log("SocketProvider");var e=Fe()("http://0.0.0.0:8001",{query:{id:t}});l(e),e.on("received-friend-request",(function(e){console.log("request-received"),d({type:"ADD_REQUEST",item:{sentUserName:e.from,fo_id:e.id,sentUserStatus:e.status}})})),e.on("received-message",(function(e){console.log("message-received"),d({type:"ADD_RECEIVED_MESSAGE",item:{from_id:e.from_id,from_name:e.from_name,to_name:e.to_name,message:e.message,timestamp:e.timestamp}})})),d({type:"SET_USER",item:a});try{var n="/friends/get_requests/".concat(a._id,"/",1,"/",30);q.get(n).then((function(e){d({type:"ADD_REQUESTS",item:e.data.data})}))}catch(r){console.log(r)}return function(){return e.close()}}),[]),r.a.createElement(Le.Provider,{value:i},c)}var Ue=a(261),Be=(a(216),a(217),a(73)),ze=a.n(Be),We=a(123),Qe=a.n(We),Ve=a(124),Ge=a.n(Ve),He=Object(h.a)((function(e){return{buttonProgress:{color:Ee.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-18,marginLeft:-18}}}));var Je=function(e){var t=e.name,a=e.status,c=e.personId,s=(e.index,e.user),o=e.received,i=e.requested,u=e.accepted,d=He(),p=Object(n.useState)(!1),f=Object(_.a)(p,2),E=f[0],b=f[1],v=Object(n.useState)(!1),h=Object(_.a)(v,2),O=h[0],N=h[1],j=function(){var e=Object(m.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,q.post("/friends/friend_request",{u_id:c,name:t,status:a,fo_id:s._id});case 4:e.sent&&(b(!1),N(!0)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),b(!1),N(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"list__main"},r.a.createElement(W.a,{className:"list__avatar"}),r.a.createElement("div",{className:"list__info"},r.a.createElement("h2",null,t),r.a.createElement("p",null,a)),r.a.createElement("div",{className:"fab"},r.a.createElement(k.a,{onClick:function(){return j()},disabled:u||i||o||O,className:"send__request"},i&&!u?r.a.createElement(fe.a,{className:"request__icon"}):o&&!u?r.a.createElement(Qe.a,{className:"request__icon"}):u?r.a.createElement(Ge.a,{className:"request__icon"}):O?r.a.createElement(fe.a,{className:"request__icon"}):r.a.createElement(ze.a,{className:"request__icon"})),E&&r.a.createElement(g.a,{size:38,className:d.buttonProgress})))},$e=Object(h.a)((function(e){return{buttonProgress:{color:Ee.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-18,marginLeft:-18}}}));var Ke=function(e){var t=e.isOpen,a=e.close,c=e.element,s=Object(n.useState)([]),o=Object(_.a)(s,2),i=o[0],u=o[1],d=Object(n.useState)(""),p=Object(_.a)(d,2),f=p[0],E=p[1],b=Object(n.useState)(!1),v=Object(_.a)(b,2),h=v[0],O=v[1],N=L(),j=Object(_.a)(N,2),w=j[0].user,C=(j[1],$e()),R=function(){var e=Object(m.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),O(!0),e.prev=2,a="/user/get_users/".concat(w._id,"/").concat(f,"/",1,"/",10),e.next=6,q.get(a);case 6:if(n=e.sent){e.next=9;break}throw new Error("empty response");case 9:console.log(n.data.data),O(!1),u(n.data.data),e.next=20;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0.message),O(!1),alert("No person with such name"),u([]);case 20:return e.prev=20,E(""),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[2,14,20,23]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"main"},r.a.createElement(y.a,{isOpen:t,appElement:c,className:"Find_Friend_Modal",overlayClassName:"Overlay"},r.a.createElement("div",{className:"findFriendModal__body"},r.a.createElement("div",{className:"findFriendModal__search"},r.a.createElement("div",{className:"findFriendModal__searchContainer"},r.a.createElement(k.a,{onClick:function(e){return R(e)}},r.a.createElement(Ue.a,null)),r.a.createElement("input",{placeholder:"Search for new friends",type:"text",onChange:function(e){return E(e.target.value)},value:f})),r.a.createElement(k.a,{onClick:function(){a(),u([])}},r.a.createElement(S.a,null))),r.a.createElement("div",{className:"findFriendModal__friends"},i.length>0&&i.map((function(e,t){return r.a.createElement(Je,{name:e.name,status:e.status,index:t,received:e.received,requested:e.requested,accepted:e.accepted,personId:e._id,user:w})})),h&&r.a.createElement(g.a,{size:38,className:C.buttonProgress})))))};var Xe=function(e){var t=e.user,a=L(),c=Object(_.a)(a,2),s=c[0],o=s.room,i=(s.messages,s.recent_rooms),l=(c[1],Object(n.useContext)(Le)),m=Object(n.useState)(!1),u=Object(_.a)(m,2),d=u[0],p=u[1];return r.a.createElement("div",{className:"chatroom__main",id:"chatroom"},r.a.createElement("div",{className:"chatroom__body",id:"chatroomBody"},r.a.createElement(Te,{user:t,findFriend:function(){p(!0)}}),r.a.createElement(Z,{sendMessage:function(e,a){i[o.id].messages.push({to_id:o.id,to_name:o.name,message:a,from_id:t._id,from_name:t.name,timestamp:Date.now()}),e.preventDefault(),console.log("sending message"),l.emit("send-message",{from_id:t._id,from_name:t.name,msg:a,to_id:o.id,to_name:o.name,timestamp:Date.now()})}})),r.a.createElement(Ke,{isOpen:d,close:function(){p(!1)},element:document.getElementById("talky")}))},Ye=a(125),Ze=a.n(Ye),et=function(e){Object(p.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).processLogin=function(){var e=Object(m.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q.post("/user/login",{email:n.state.loginEmail,password:n.state.loginPwd});case 3:if(a=e.sent,r=a.data,console.log(r),r._id){e.next=8;break}throw new Error("undefined id received");case 8:console.log("resUser = ".concat(r)),n.setState((function(e){return{isLoginActive:!1,isChatroomActive:!e.isChatroomActive,user:r}})),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0.message),alert("login failed");case 16:return e.prev=16,t(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,12,16,19]])})));return function(t){return e.apply(this,arguments)}}(),n.processLoginEmail=function(e){n.setState({loginEmail:e.target.value})},n.processLoginPassword=function(e){n.setState({loginPwd:e.target.value})},n.flip=function(){n.setState((function(e){return Object(o.a)(Object(o.a)({},n.state),{},{isFlipped:!e.isFlipped})}))},n.state={isLoginActive:!0,isChatroomActive:!1,user:{},loginEmail:"",loginPwd:"",isFlipped:!1},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoginActive,n=t.isChatroomActive,c=t.user;return r.a.createElement("div",{className:"app",id:"talky"},r.a.createElement("div",{className:"app__container"},a&&r.a.createElement("div",{className:"banner"},r.a.createElement("div",{className:"banner_image"},r.a.createElement("img",{src:E,alt:"banner"}),r.a.createElement("h1",null,"Join and start connecting with your loved ones."))),r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"container"},a&&r.a.createElement(Ze.a,{isFlipped:this.state.isFlipped,containerStyle:{width:"100%",height:"100%",alignItems:"center"},flipDirection:"horizontal"},r.a.createElement(N,{containerRef:function(t){return e.current=t},processLogin:this.processLogin,processLoginEmail:this.processLoginEmail,processLoginPassword:this.processLoginPassword,flip:this.flip}),r.a.createElement(T,{containerRef:function(t){return e.current=t},flip:this.flip})),n&&r.a.createElement(Ie,{id:c._id,user:c},r.a.createElement(Xe,{user:c}))))))}}]),a}(r.a.Component),tt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function at(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,{initialState:{user:{},room:{},messages:[],recent_rooms:{},requests:[],fromMeRequestedFriends:[],toMeRequestedFriends:[]},reducer:function(e,t){switch(t.type){case"SET_USER":return Object(o.a)(Object(o.a)({},e),{},{user:t.item});case"SET_ROOM":return Object(o.a)(Object(o.a)({},e),{},{room:t.item});case"ADD_ROOM":return Object(o.a)(Object(o.a)({},e),{},{recent_rooms:Object(o.a)(Object(o.a)({},e.recent_rooms),t.item)});case"ADD_RECEIVED_MESSAGE":var a=Object(o.a)({},e.recent_rooms);return console.log("received reducer"),a[t.item.from_id].messages.push(t.item),Object(o.a)(Object(o.a)({},e),{},{recent_rooms:Object(o.a)({},a)});case"ADD_MESSAGE":return Object(o.a)(Object(o.a)({},e),{},{messages:[].concat(Object(le.a)(e.messages),[t.item])});case"ADD_REQUEST":return Object(o.a)(Object(o.a)({},e),{},{requests:[].concat(Object(le.a)(e.requests),[t.item])});case"ADD_REQUESTS":case"RESET_REQUESTS":return Object(o.a)(Object(o.a)({},e),{},{requests:Object(le.a)(t.item)});case"ADD_FROM_ME_FRIENDS":return Object(o.a)(Object(o.a)({},e),{},{fromMeRequestedFriends:Object(le.a)(t.item)});case"ADD_TO_ME_FRIENDS":return Object(o.a)(Object(o.a)({},e),{},{toMeRequestedFriends:Object(le.a)(t.item)});default:return e}}},r.a.createElement(et,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");tt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):at(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):at(t,e)}))}}()}},[[218,1,2]]]);
//# sourceMappingURL=main.d8ad5a26.chunk.js.map